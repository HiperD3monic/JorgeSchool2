<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Form View for School Mention Section -->
    <record id="school_mention_section_view_form" model="ir.ui.view">
        <field name="name">school.mention.section.form</field>
        <field name="model">school.mention.section</field>
        <field name="arch" type="xml">
            <form string="Mención Inscrita">
                <header/>
                <sheet>
                    <div class="oe_title">
                        <h1>
                            <field name="display_name"/>
                        </h1>
                    </div>
                    
                    <group>
                        <group string="Información Principal">
                            <field name="year_id"/>
                            <field name="mention_id"/>
                            <field name="lapso_inscripcion" readonly="1"/>
                            <field name="active" invisible="1"/>
                        </group>
                        <group string="Estadísticas">
                            <field name="student_count"/>
                            <field name="subject_count"/>
                            <field name="create_date" readonly="1" string="Fecha de Inscripción"/>
                        </group>
                    </group>
                    
                    <notebook>
                        <page string="Materias" name="subjects">
                            <field name="subject_ids" context="{'default_mention_section_id': id}">
                                <list editable="bottom">
                                    <field name="mention_section_id" column_invisible="1"/>
                                    <field name="subject_id"/>
                                    <field name="professor_id"/>
                                </list>
                            </field>
                        </page>
                        <page string="Estudiantes" name="students">
                            <field name="student_ids" readonly="1">
                                <list>
                                    <field name="student_id"/>
                                    <field name="section_id"/>
                                    <field name="state"/>
                                    <field name="mention_state"/>
                                </list>
                            </field>
                        </page>
                        <page string="Horarios" name="schedules">
                            <field name="schedule_ids" context="{'default_mention_section_id': id}">
                                <list>
                                    <field name="day_of_week"/>
                                    <field name="start_time" widget="float_time"/>
                                    <field name="end_time" widget="float_time"/>
                                    <field name="subject_id"/>
                                    <field name="professor_id"/>
                                    <field name="classroom"/>
                                </list>
                            </field>
                        </page>
                        <page string="Evaluaciones" name="evaluations">
                            <field name="evaluation_ids" readonly="1">
                                <list>
                                    <field name="name"/>
                                    <field name="subject_id"/>
                                    <field name="professor_id"/>
                                    <field name="lapso"/>
                                    <field name="evaluation_date"/>
                                    <field name="state"/>
                                    <field name="score_average"/>
                                </list>
                            </field>
                        </page>
                        <page string="Rendimiento" name="performance">
                            <group>
                                <group string="Promedios de Materias">
                                    <field name="subjects_average_json" widget="subjects_average_graph" colspan="2" nolabel="1"/>
                                </group>
                                <group string="Promedios de Estudiantes">
                                    <field name="students_average_json" widget="students_average_graph" colspan="2" nolabel="1"/>
                                </group>
                                <group string="Top 5 Estudiantes">
                                    <field name="top_students_json" widget="top_students_graph" colspan="2" nolabel="1"/>
                                </group>
                            </group>
                        </page>
                    </notebook>
                </sheet>
                <chatter/>
            </form>
        </field>
    </record>

    <!-- List View for School Mention Section -->
    <record id="school_mention_section_view_list" model="ir.ui.view">
        <field name="name">school.mention.section.list</field>
        <field name="model">school.mention.section</field>
        <field name="arch" type="xml">
            <list string="Menciones Inscritas">
                <field name="year_id"/>
                <field name="mention_id"/>
                <field name="student_count"/>
                <field name="subject_count"/>
                <field name="lapso_inscripcion" optional="hide"/>
                <field name="create_date" string="Fecha Inscripción" optional="hide"/>
                <field name="current" optional="hide"/>
            </list>
        </field>
    </record>

    <!-- Search View for School Mention Section -->
    <record id="school_mention_section_view_search" model="ir.ui.view">
        <field name="name">school.mention.section.search</field>
        <field name="model">school.mention.section</field>
        <field name="arch" type="xml">
            <search string="Buscar Menciones Inscritas">
                <field name="year_id"/>
                <field name="mention_id"/>
                <filter string="Año Actual" name="current_year" domain="[('current', '=', True)]"/>
                <filter string="Años Anteriores" name="historical" domain="[('current', '=', False)]"/>
            </search>
        </field>
    </record>

    <!-- Action for Current Mentions (default) -->
    <record id="school_mention_section_action" model="ir.actions.act_window">
        <field name="name">Menciones Inscritas (Actual)</field>
        <field name="res_model">school.mention.section</field>
        <field name="view_mode">list,form</field>
        <field name="domain">[('current', '=', True)]</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                Inscribir una nueva mención
            </p>
            <p>
                Inscriba menciones técnicas en el año escolar actual.
            </p>
        </field>
    </record>

    <!-- Action for Historical Mentions -->
    <record id="school_mention_section_action_history" model="ir.actions.act_window">
        <field name="name">Menciones Inscritas (Histórico)</field>
        <field name="res_model">school.mention.section</field>
        <field name="view_mode">list,form</field>
        <field name="domain">[('current', '=', False)]</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                No hay menciones de años anteriores
            </p>
        </field>
    </record>

</odoo>
